<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#a855f7">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Habit Tracker">
    <title>Habit Tracker - Consistency Over Excuses</title>
    <link rel="manifest" href="{{ url_for('static', filename='manifest.json') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <div>
                <h1 class="motivational-text">This year I'm choosing <span class="highlight">CONSISTENCY</span> over excuses.</h1>
                <div class="user-actions">
                    <div class="sync-status" id="sync-status">
                        <span class="sync-icon" id="sync-icon">üîÑ</span>
                        <span class="sync-text" id="sync-text">Synced</span>
                    </div>
                    <span id="user-info"></span>
                    <a href="/logout" class="btn-primary" style="text-decoration: none; padding: 10px 20px; font-size: 14px;">Logout</a>
                </div>
            </div>
        </header>

        <div class="tabs">
            <button class="tab-btn active" data-tab="tracker">Daily Tracker</button>
            <button class="tab-btn" data-tab="dashboard">Dashboard</button>
            <button class="tab-btn" data-tab="settings">Settings</button>
        </div>

        <!-- Daily Tracker Tab -->
        <div id="tracker-tab" class="tab-content active">
            <div class="month-selector">
                <button id="prev-month" class="month-btn">‚Üê</button>
                <h2 id="current-month-year"></h2>
                <button id="next-month" class="month-btn">‚Üí</button>
            </div>
            
            <div class="loading-overlay" id="tracker-loading">
                <div class="spinner"></div>
                <p>Loading habits...</p>
            </div>
            
            <div class="table-container" id="table-container">
                <table id="habit-table">
                    <thead>
                        <tr>
                            <th class="habit-col">DAILY HABITS</th>
                            <th class="goal-col">GOAL</th>
                            <th id="week-headers"></th>
                        </tr>
                    </thead>
                    <tbody id="habit-tbody">
                        <!-- Habits will be loaded here -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Dashboard Tab -->
        <div id="dashboard-tab" class="tab-content">
            <div class="loading-overlay" id="dashboard-loading">
                <div class="spinner"></div>
                <p>Loading dashboard...</p>
            </div>
            <div class="dashboard-grid" id="dashboard-grid">
                <div class="dashboard-section">
                    <h2>Progress Overview</h2>
                    <div id="progress-cards" class="progress-cards">
                        <!-- Progress cards will be loaded here -->
                    </div>
                </div>
                
                <div class="dashboard-section">
                    <h2>Category Summary</h2>
                    <canvas id="category-chart"></canvas>
                </div>
                
                <div class="dashboard-section">
                    <h2>Weekly Progress</h2>
                    <canvas id="weekly-chart"></canvas>
                </div>
            </div>
        </div>

        <!-- Settings Tab -->
        <div id="settings-tab" class="tab-content">
            <div class="settings-container">
                <h2>Manage Habits</h2>
                <button id="add-habit-btn" class="btn-primary">+ Add New Habit</button>
                <div id="habits-list" class="habits-list">
                    <!-- Habits list will be loaded here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Add Habit Modal -->
    <div id="add-habit-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Add New Habit</h2>
            <form id="add-habit-form">
                <div class="form-group">
                    <label>Habit Name</label>
                    <input type="text" id="habit-name" required>
                </div>
                <div class="form-group">
                    <label>Emoji</label>
                    <input type="text" id="habit-emoji" placeholder="‚úÖ" maxlength="2">
                </div>
                <div class="form-group">
                    <label>Category</label>
                    <select id="habit-category">
                        <option value="Fitness">Fitness</option>
                        <option value="Health">Health</option>
                        <option value="Productivity">Productivity</option>
                        <option value="Study">Study</option>
                        <option value="Money">Money</option>
                        <option value="Social">Social</option>
                        <option value="Other">Other</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Monthly Goal (days)</label>
                    <input type="number" id="habit-goal" value="30" min="1" max="31" required>
                </div>
                <button type="submit" class="btn-primary">Add Habit</button>
            </form>
        </div>
    </div>

    <!-- Toast Notification Container -->
    <div id="toast-container" class="toast-container"></div>

    <!-- Pull to Refresh Indicator -->
    <div id="pull-refresh" class="pull-refresh">
        <div class="pull-refresh-icon">‚¨áÔ∏è</div>
        <div class="pull-refresh-text">Pull to refresh</div>
    </div>

    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
    <script>
        // Register Service Worker for PWA
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('{{ url_for("static", filename="sw.js") }}')
                    .then((registration) => {
                        console.log('Service Worker registered:', registration);
                    })
                    .catch((error) => {
                        console.log('Service Worker registration failed:', error);
                    });
            });
        }
    </script>
</body>
</html>


